{"ast":null,"code":"var priceUpdate = function priceUpdate(e) {\n  var activity_ids = [];\n  document.querySelectorAll('.selected-activities').forEach(function (activity) {\n    if (activity.value !== \"\") {\n      activity_ids.push(activity.value);\n    }\n  });\n  fetch('/activities/calculate_experience', {\n    method: \"POST\",\n    headers: {\n      'X-CSRF-Token': document.querySelector(\"input[name='authenticity_token']\").value,\n      'Content-type': \"application/json\"\n    },\n    body: JSON.stringify({\n      activity_ids: activity_ids\n    })\n  }).then(function (response) {\n    return response.json();\n  }).then(function (data) {\n    document.querySelector('#prix').innerHTML = data[\"amount\"];\n    document.querySelector('#duration').innerText = \"\".concat(Math.floor(data[\"duration\"] / 60), \" h \").concat(data[\"duration\"] % 60, \" min\");\n  });\n};\n\nvar dragged;\n/* events fired on the draggable target */\n\ndocument.addEventListener(\"drag\", function (event) {});\ndocument.addEventListener(\"dragstart\", function (event) {\n  // store a ref. on the dragged elem\n  dragged = event.target; // make it half transparent\n\n  event.target.style.opacity = .5;\n});\ndocument.addEventListener(\"dragend\", function (event) {\n  // reset the transparency\n  event.target.style.opacity = \"\";\n});\n/* events fired on the drop targets */\n\ndocument.addEventListener(\"dragover\", function (event) {\n  // prevent default to allow drop\n  event.preventDefault();\n});\ndocument.addEventListener(\"dragenter\", function (event) {\n  // highlight potential drop target when the draggable element enters it\n  if (event.target.className.includes(\"dropzone\")) {\n    event.target.style.background = \"#FEA126\";\n  }\n});\ndocument.addEventListener(\"dragleave\", function (event) {\n  // reset background of potential drop target when the draggable element leaves it\n  if (event.target.className.includes(\"dropzone\")) {\n    event.target.style.background = \"\";\n  }\n});\ndocument.addEventListener(\"drop\", function (event) {\n  event.preventDefault(); // copy dragged elem to the selected drop target\n\n  if (event.target.className.includes(\"dropzone\")) {\n    event.target.style.background = \"\";\n    event.target.appendChild(dragged.cloneNode(true));\n    event.target.nextElementSibling.value = dragged.getAttribute('value');\n    event.target.style.opacity = 1;\n    dragged.style.background = \"green\";\n    event.target.insertAdjacentHTML(\"afterbegin\", \"<a class='boxclose' id=boxclose\".concat(dragged.getAttribute('value'), \"></a>\"));\n    removeElement(event.target, dragged);\n    priceUpdate(event);\n  }\n});\n\nremoveElement = function removeElement(dropTarget, draggedElement) {\n  boxclose = document.querySelector(\"#boxclose\".concat(draggedElement.getAttribute('value')));\n  boxclose.addEventListener('click', function (event) {\n    event.target.nextElementSibling.remove();\n    draggedElement.style.background = \"\";\n    dropTarget.nextElementSibling.value = \"\";\n    event.target.remove();\n    priceUpdate(event);\n  });\n};","map":{"version":3,"sources":["/Users/francoiscapel/code/ginger/Ginger/app/javascript/components/draggable.js"],"names":["priceUpdate","e","activity_ids","document","querySelectorAll","forEach","activity","value","push","fetch","method","headers","querySelector","body","JSON","stringify","then","response","json","data","innerHTML","innerText","Math","floor","dragged","addEventListener","event","target","style","opacity","preventDefault","className","includes","background","appendChild","cloneNode","nextElementSibling","getAttribute","insertAdjacentHTML","removeElement","dropTarget","draggedElement","boxclose","remove"],"mappings":"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","sourcesContent":["const priceUpdate = (e) => {\n  const activity_ids = [];\n  document.querySelectorAll('.selected-activities').forEach((activity) => {\n    if (activity.value !== \"\") {\n      activity_ids.push(activity.value);\n    }\n  });\n  fetch('/activities/calculate_experience', {\n    method: \"POST\",\n    headers: { 'X-CSRF-Token': document.querySelector(\"input[name='authenticity_token']\").value, 'Content-type': \"application/json\" },\n    body: JSON.stringify({ activity_ids: activity_ids })\n  })\n  .then(response => response.json())\n  .then((data) => {\n    document.querySelector('#prix').innerHTML = data[\"amount\"]\n    document.querySelector('#duration').innerText = `${Math.floor(data[\"duration\"] / 60)} h ${data[\"duration\"] % 60} min`\n  });\n}\n\nlet dragged;\n\n/* events fired on the draggable target */\ndocument.addEventListener(\"drag\", (event) => {});\n\ndocument.addEventListener(\"dragstart\", (event) => {\n  // store a ref. on the dragged elem\n  dragged = event.target;\n  // make it half transparent\n  event.target.style.opacity = .5;\n});\n\ndocument.addEventListener(\"dragend\", (event) => {\n  // reset the transparency\n  event.target.style.opacity = \"\";\n});\n\n/* events fired on the drop targets */\ndocument.addEventListener(\"dragover\", (event) => {\n  // prevent default to allow drop\n  event.preventDefault();\n});\n\ndocument.addEventListener(\"dragenter\", (event) => {\n  // highlight potential drop target when the draggable element enters it\n  if ( event.target.className.includes(\"dropzone\")) {\n    event.target.style.background = \"#FEA126\";\n  }\n});\n\ndocument.addEventListener(\"dragleave\", (event) => {\n  // reset background of potential drop target when the draggable element leaves it\n  if ( event.target.className.includes(\"dropzone\")) {\n    event.target.style.background = \"\";\n  }\n});\n\ndocument.addEventListener(\"drop\", (event) => {\n  event.preventDefault();\n  // copy dragged elem to the selected drop target\n  if (event.target.className.includes(\"dropzone\")) {\n    event.target.style.background = \"\";\n    event.target.appendChild(dragged.cloneNode(true));\n    event.target.nextElementSibling.value = dragged.getAttribute('value');\n    event.target.style.opacity = 1;\n    dragged.style.background = \"green\";\n    event.target.insertAdjacentHTML(\"afterbegin\", `<a class='boxclose' id=boxclose${dragged.getAttribute('value')}></a>`)\n    removeElement(event.target, dragged);\n    priceUpdate(event);\n  }\n});\n\nremoveElement = (dropTarget, draggedElement) => {\n  boxclose = document.querySelector(`#boxclose${draggedElement.getAttribute('value')}`);\n    boxclose.addEventListener('click', (event) => {\n      event.target.nextElementSibling.remove();\n      draggedElement.style.background = \"\";\n      dropTarget.nextElementSibling.value = \"\";\n      event.target.remove();\n      priceUpdate(event);\n    });\n}\n\n\n"]},"metadata":{},"sourceType":"module"}